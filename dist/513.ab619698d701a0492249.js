(()=>{"use strict";var e,t,n,r,s,o,a,i={907:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{J5:()=>a,QZ:()=>i,ey:()=>u,h3:()=>l});var r=n(180),s=n(142),o=e([s]);function a(e,t){try{return c(e,t).length}catch(e){throw console.error("get_file_len",e),e}}s=(o.then?await o:o)[0];const i=new Map;function c(e,t){let n=i.get(e);if(n||(n=new p({rangeMapper:(t,n)=>({url:e,fromByte:t,toByte:n}),requestChunkSize:t,logPageReads:!0,cacheRequestedChunk:!1}),i.set(e,n)),n.chunkSize!==t)throw Error("Wrong chunk size");return n}function h(e){return e.split("/").slice(-1)[0]}function u(e,t,n,r,s){c(e,t).copyInto(s,0,r-n,n,0)}function l(e,t,n){c(e,t).ensureChunksCached([...n])}const d="\r".charCodeAt(0),f="\n".charCodeAt(0);function g(e,t){console.time("parseMultipart");const n=new Uint8Array(e);let r=0,s=0;const o=[];for(;n[r]==="\r".charCodeAt(0);)r+=2;for(;s<t.length;){if(n[r+0]===d&&n[r+1]===f&&n[r+2]===d&&n[r+3]===f){r+=4;const e=t[s++];o.push(n.subarray(r,r+e)),r+=e}r++}return console.timeEnd("parseMultipart"),o}class p{constructor(e){this.serverChecked=!1,this.chunks=[],this.totalFetchedBytes=0,this.totalRequests=0,this.readPages=[],this.readHeads=[],this.lastGet=-1,this._chunkSize=e.requestChunkSize,this.maxSpeed=Math.round((e.maxReadSpeed||5242880)/this._chunkSize),this.maxReadHeads=e.maxReadHeads??3,this.rangeMapper=e.rangeMapper,this.logPageReads=e.logPageReads??!1,e.fileLength&&(this._length=e.fileLength),this.cacheRequestedChunk=e.cacheRequestedChunk??!0}copyInto(e,t,n,r,s){if(r>=this.length)return 0;const o=r+(n=Math.min(this.length-r,n));let a=0;for(this.chunkSize;a<n;){const n=r+a,s=n%this.chunkSize,i=n/this.chunkSize|0,c=Math.min(this.chunkSize,o-n);let h=this.getChunk(i);0===s&&c===this.chunkSize||(h=h.subarray(s,s+c)),e.set(h,t+a),a+=h.length}return n}moveReadHead(e){for(const[t,n]of this.readHeads.entries()){const r=n.startChunk+n.speed,s=Math.min(this.maxSpeed,2*n.speed);if(e>=r&&e<r+s)return n.speed=s,n.startChunk=r,0!==t&&(this.readHeads.splice(t,1),this.readHeads.unshift(n)),n}const t={startChunk:e,speed:1};for(this.readHeads.unshift(t);this.readHeads.length>this.maxReadHeads;)this.readHeads.pop();return t}ensureChunksCached(e){if(this.logPageReads)for(const t of e)void 0!==this.chunks[t]&&this.readPages.push({pageno:t,wasCached:!0,prefetch:0,reason:"[no tracking when cached]"});const t=new Set(e.filter((e=>void 0===this.chunks[e])).sort(((e,t)=>e-t)));console.log("ensureCached",t),this.fetchChunks([...t])}fetchChunks(e){if(0===e.length)return;const t=[],n=e.slice(1).reduce((([e,n],r)=>n+1===r?[e,r]:(t.push([e,n]),[r,r])),[e[0],e[0]]);t.push(n);const s=[];for(const[e,n]of t){const t=this.moveReadHead(e),r=t.startChunk,o=Math.max(r+t.speed-1,n),a=r*this.chunkSize,i=(o+1)*this.chunkSize-1,c=Math.min(i,this.length-1),h=i-c;s.push({chunks:[r,o],bytes:[a,c],lastChunkSize:this.chunkSize-h})}if(console.log("ranges",s),this.logPageReads){const e=s.reduce(((e,t)=>e+t.chunks[1]-t.chunks[0]+1),0);this.readPages.push({pageno:t[0][0],wasCached:!1,prefetch:e-1,reason:r.parse(new Error).filter((e=>e.fileName?.includes(".wasm"))).map((e=>e.functionName)).filter((e=>e?.includes("tantivy::")&&!e.includes("tantivy::directory"))).slice(0,30).join("\n")})}const o=this.doXHR(s.map((e=>e.bytes)));for(const[e,t]of o.entries()){let n=0;const{chunks:[r,o],lastChunkSize:a}=s[e];console.log("handling res",e,r,o);for(let e=r;e<=o;e++){const r=e===o?a:this.chunkSize,s=t.subarray(n,n+r);n+=r,console.log("SETCHUNK",e,s),this.chunks[e]=s}if(n!==t.byteLength)throw Error(`left over response data? ${n} != ${t.byteLength}`)}}getChunk(e){if(void 0===this.chunks[e])throw Error(`chunk not cached? @${e} ${this.rangeMapper(0,1).url}`);return this.chunks[e]}checkServer(){var e=new XMLHttpRequest;const t=this.rangeMapper(0,0).url;if(e.open("HEAD",t,!1),e.setRequestHeader("Accept-Encoding","identity"),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+t+". Status: "+e.status);var n=Number(e.getResponseHeader("Content-length")),r="bytes"===e.getResponseHeader("Accept-Ranges"),s="gzip"===e.getResponseHeader("Content-Encoding");if(!r){const t="server either does not support byte serving or does not advertise it (`Accept-Ranges: bytes` header missing), or your database is hosted on CORS and the server doesn't mark the accept-ranges header as exposed.";console.warn(t,"seen response headers:",e.getAllResponseHeaders())}if(s||!n)throw console.error("response headers",e.getAllResponseHeaders()),Error("server uses gzip or doesn't have length");this._length||(this._length=n),this.serverChecked=!0}get length(){if(!this.serverChecked)try{this.checkServer()}catch(e){throw console.error("checkServer",e),e}return this._length}get chunkSize(){return this.serverChecked||this.checkServer(),this._chunkSize}doXHR(e){const t=new Map;for(const[n,r]of e){if(this.totalFetchedBytes+=r-n,r>this.length-1)throw new Error("only "+this.length+" bytes available! programmer error!");const{fromByte:e,toByte:s,url:o}=this.rangeMapper(n,r);let a=t.get(o);a||(a=[],t.set(o,a)),a.push([e,s])}if(this.totalRequests+=t.size,t.size>1)throw Error("chunk split currently not supported");for(const[e,r]of t){(0,s.y)({inc:1});const t=r.reduce(((e,[t,n])=>e+n-t+1),0);console.log(`[xhr ${h(e)} of ${t/1024} KiB]`);var n=new XMLHttpRequest;if(n.open("GET",e,!1),this.length!==this.chunkSize&&n.setRequestHeader("Range","bytes="+r.map((([e,t])=>`${e}-${t}`)).join(", ")),n.responseType="arraybuffer",n.overrideMimeType&&n.overrideMimeType("application/octet-stream"),n.send(null),!(n.status>=200&&n.status<300||304===n.status))throw new Error("Couldn't load "+e+". Status: "+n.status);if(void 0!==n.response){const e=n.response;return r.length>1?g(e,r.map((([e,t])=>t-e+1))):[new Uint8Array(e)]}throw Error("xhr did not return array buffer")}throw Error("no request??")}getCachedChunks(){const e=[];for(let t in this.chunks)e.push([+t,this.chunks[t]]);return e}}}))},142:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{H:()=>i,y:()=>c});var r=n(870),s=n(838),o=n(907),a=e([o,s]);function i(e){c({inc:0,message:e})}function c(e){self.postMessage({type:"progress",data:e})}[o,s]=a.then?await a:a,console.log("S",location.search);const h={search(e){for(const e of o.QZ.values())e.readPages=[];return JSON.parse((0,s.yC)(e.indexUrl,e.chunkSize,e.fields,e.rank,e.searchText))},getReadStats:function(){const e=new Map;for(const[t,n]of o.QZ)for(const t of n.readPages)for(const r of[t.reason,"Total"]){const s=n.chunkSize*(t.prefetch+1);let o=e.get(r);o||(o={reason:r,fetchedAmount:0,requestCount:0,totalReadCount:0,cachedReadAmount:0},e.set(r,o)),t.wasCached?o.cachedReadAmount+=s:(o.fetchedAmount+=s,o.requestCount+=1),o.totalReadCount+=1}const t=[...e.values()];return t.sort(((e,t)=>t.fetchedAmount-e.fetchedAmount)),t},getIndexStats:(e,t)=>JSON.parse((0,s._k)(e,t)),dumpCache(){const e=[];for(const[t,n]of o.QZ)e.push([t,n.getCachedChunks()]);return e}};r.Jj(h),self.postMessage("inited")}))},838:(e,t,n)=>{n.a(e,(async e=>{n.d(t,{yC:()=>x,_k:()=>z,Mf:()=>A,ug:()=>H,$n:()=>M,d8:()=>E,h9:()=>O,Dz:()=>j,kF:()=>q,qt:()=>P,W3:()=>$,h4:()=>T,Wj:()=>B,Or:()=>W,nD:()=>L});var r=n(907),s=n(142),o=n(716),a=e([s,o,r]);[s,o,r]=a.then?await a:a;const i=new Array(32).fill(void 0);function c(e){return i[e]}i.push(void 0,null,!0,!1);let h=i.length;function u(e){const t=c(e);return function(e){e<36||(i[e]=h,h=e)}(e),t}let l=0,d=null;function f(){return null!==d&&d.buffer===o.memory.buffer||(d=new Uint8Array(o.memory.buffer)),d}let g=new TextEncoder("utf-8");const p="function"==typeof g.encodeInto?function(e,t){return g.encodeInto(e,t)}:function(e,t){const n=g.encode(e);return t.set(n),{read:e.length,written:n.length}};function _(e,t,n){if(void 0===n){const n=g.encode(e),r=t(n.length);return f().subarray(r,r+n.length).set(n),l=n.length,r}let r=e.length,s=t(r);const o=f();let a=0;for(;a<r;a++){const t=e.charCodeAt(a);if(t>127)break;o[s+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),s=n(s,r,r=a+3*e.length);const t=f().subarray(s+a,s+r);a+=p(e,t).written}return l=a,s}function b(e){return null==e}let w=null;function y(){return null!==w&&w.buffer===o.memory.buffer||(w=new Int32Array(o.memory.buffer)),w}let m=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});function k(e,t){return m.decode(f().subarray(e,e+t))}function v(e){h===i.length&&i.push(i.length+1);const t=h;return h=i[t],i[t]=e,t}function C(e,t){try{return e.apply(this,t)}catch(e){o.__wbindgen_exn_store(v(e))}}m.decode();let S=null;let R=null;function x(e,t,n,r,s){try{const p=o.__wbindgen_add_to_stack_pointer(-16);var a=_(e,o.__wbindgen_malloc,o.__wbindgen_realloc),i=l,c=b(n)?0:function(e,t){const n=t(4*e.length),r=(null!==R&&R.buffer===o.memory.buffer||(R=new Uint32Array(o.memory.buffer)),R);for(let t=0;t<e.length;t++)r[n/4+t]=v(e[t]);return l=e.length,n}(n,o.__wbindgen_malloc),h=l,u=_(s,o.__wbindgen_malloc,o.__wbindgen_realloc),d=l;o.search(p,a,i,t,c,h,r,u,d);var f=y()[p/4+0],g=y()[p/4+1];return k(f,g)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(f,g)}}function z(e,t){try{const i=o.__wbindgen_add_to_stack_pointer(-16);var n=_(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=l;o.get_dataset_info(i,n,r,t);var s=y()[i/4+0],a=y()[i/4+1];return k(s,a)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(s,a)}}function A(){return C((function(e,t,n){try{return(0,r.J5)(k(e,t),n)}finally{o.__wbindgen_free(e,t)}}),arguments)}function H(e){u(e)}function M(e,t,n,s,a){try{(0,r.h3)(k(e,t),n,(i=s,c=a,(null!==S&&S.buffer===o.memory.buffer||(S=new Float64Array(o.memory.buffer)),S).subarray(i/8,i/8+c)))}finally{o.__wbindgen_free(e,t)}var i,c}function E(e,t,n,s,a,i,c){try{(0,r.ey)(k(e,t),n,s,a,(h=i,u=c,f().subarray(h/1,h/1+u)))}finally{o.__wbindgen_free(e,t)}var h,u}function O(){return v(new Error)}function j(e,t){var n=_(c(t).stack,o.__wbindgen_malloc,o.__wbindgen_realloc),r=l;y()[e/4+1]=r,y()[e/4+0]=n}function q(e,t){try{console.error(k(e,t))}finally{o.__wbindgen_free(e,t)}}function P(e,t){const n=c(t);var r="string"==typeof n?n:void 0,s=b(r)?0:_(r,o.__wbindgen_malloc,o.__wbindgen_realloc),a=l;y()[e/4+1]=a,y()[e/4+0]=s}function $(e,t){console.log(k(e,t))}function T(e,t){return v(k(e,t))}function B(e,t){(0,s.H)(k(e,t))}function W(e,t){throw new Error(k(e,t))}function L(e){throw u(e)}}))},716:(e,t,n)=>{var r=([r])=>n.v(t,e.id,"8f4dbcf03c0050d1dd73",{"./index_bg.js":{__wbg_getfilelen_8833a432c73baa51:r.Mf,__wbindgen_object_drop_ref:r.ug,__wbg_ensurechunkscached_63dead0374b4c2d8:r.$n,__wbg_readbytesfromfile_e0dbde51969da0fd:r.d8,__wbg_new_59cb74e423758ede:r.h9,__wbg_stack_558ba5917b466edd:r.Dz,__wbg_error_4bb6c2a97407129a:r.kF,__wbindgen_string_get:r.qt,__wbg_log_daa502f216282308:r.W3,__wbindgen_string_new:r.h4,__wbg_tantivyLog_24954b697db4d74d:r.Wj,__wbindgen_throw:r.Or,__wbindgen_rethrow:r.nD}});n.a(e,(e=>{var t=e([n(838)]);return t.then?t.then(r):r(t)}),1)}},c={};function h(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={id:e,exports:{}};return i[e].call(n.exports,n,n.exports,h),n.exports}h.m=i,h.x=()=>{var e=h.O(void 0,[476],(()=>h(142)));return h.O(e)},e="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n=e=>{e&&(e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},r=e=>!--e.r&&e(),s=(e,t)=>e?e.push(t):r(t),h.a=(o,a,i)=>{var c,h,u,l=i&&[],d=o.exports,f=!0,g=!1,p=(t,n,r)=>{g||(g=!0,n.r+=t.length,t.map(((t,s)=>t[e](n,r))),g=!1)},_=new Promise(((e,t)=>{u=t,h=()=>(e(d),n(l),l=0)}));_[t]=d,_[e]=(e,t)=>{if(f)return r(e);c&&p(c,e,t),s(l,e),_.catch(t)},o.exports=_,a((o=>{if(!o)return h();var a,i;c=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var a=[];o.then((e=>{i[t]=e,n(a),a=0}));var i={[e]:(e,t)=>(s(a,e),o.catch(t))};return i}}return{[e]:e=>r(e),[t]:o}})))(o);var u=new Promise(((e,n)=>{(a=()=>e(i=c.map((e=>e[t])))).r=0,p(c,a,n)}));return a.r?u:i})).then(h,u),f=!1},o=[],h.O=(e,t,n,r)=>{if(!t){var s=1/0;for(c=0;c<o.length;c++){for(var[t,n,r]=o[c],a=!0,i=0;i<t.length;i++)(!1&r||s>=r)&&Object.keys(h.O).every((e=>h.O[e](t[i])))?t.splice(i--,1):(a=!1,r<s&&(s=r));a&&(o.splice(c--,1),e=n())}return e}r=r||0;for(var c=o.length;c>0&&o[c-1][2]>r;c--)o[c]=o[c-1];o[c]=[t,n,r]},h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},h.d=(e,t)=>{for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.f={},h.e=e=>Promise.all(Object.keys(h.f).reduce(((t,n)=>(h.f[n](e,t),t)),[])),h.u=e=>e+".af365759ff92eb483912.js",h.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;h.g.importScripts&&(e=h.g.location+"");var t=h.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),h.p=e})(),(()=>{var e={513:1};h.f.i=(t,n)=>{e[t]||importScripts(h.p+h.u(t))};var t=self.webpackChunk=self.webpackChunk||[],n=t.push.bind(t);t.push=t=>{var[r,s,o]=t;for(var a in s)h.o(s,a)&&(h.m[a]=s[a]);for(o&&o(h);r.length;)e[r.pop()]=1;n(t)}})(),h.v=(e,t,n,r)=>{var s=fetch(h.p+""+n+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(s,r).then((t=>Object.assign(e,t.instance.exports))):s.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,r))).then((t=>Object.assign(e,t.instance.exports)))},a=h.x,h.x=()=>h.e(476).then(a),h.x()})();